<section id="export-panel" class="panel-soft stack-sm" {% if oob %}hx-swap-oob="outerHTML"{% endif %}>
  <h2>Export Gates</h2>
  <ul class="list checks">
    <li class="{{ 'ok' if export_gate.checks.run_succeeded else 'bad' }}">run.status == succeeded</li>
    <li class="{{ 'ok' if export_gate.checks.artifact_fr_exists else 'bad' }}">FR artifact exists</li>
    <li class="{{ 'ok' if export_gate.checks.artifact_en_exists else 'bad' }}">EN artifact exists</li>
    <li class="{{ 'ok' if export_gate.checks.artifact_fr_reviewed else 'bad' }}">FR reviewed == true</li>
    <li class="{{ 'ok' if export_gate.checks.artifact_en_reviewed else 'bad' }}">EN reviewed == true</li>
    <li class="{{ 'ok' if export_gate.checks.claims_to_verify_empty else 'bad' }}">claims_to_verify empty/missing</li>
  </ul>

  {% if export_gate.reasons %}
  <div class="flash error">
    <strong>Export blocked</strong>
    <ul class="list">{% for reason in export_gate.reasons %}<li>{{ reason }}</li>{% endfor %}</ul>
  </div>
  {% endif %}

  {% if export_message %}
  <div class="flash info">
    <strong>{{ export_message }}</strong>
    {% if export_files %}
    <ul class="list">
      <li>FR: <code>{{ export_files.fr }}</code></li>
      <li>EN: <code>{{ export_files.en }}</code></li>
    </ul>
    {% endif %}
  </div>
  {% endif %}

  <form hx-post="/admin/runs/{{ run.id }}/export" hx-target="#export-panel" hx-swap="outerHTML">
    <button class="btn" type="submit" {% if not export_gate.ready %}disabled{% endif %}>Export FR + EN</button>
  </form>
</section>
